---
export interface Props {
  title: string;
  activeNav?: string;
}

const { title, activeNav } = Astro.props;
const user = (Astro.locals as any).user;

const navItems = [
  { href: '/admin/', label: 'Dashboard', icon: 'üìä' },
  { href: '/admin/review/', label: 'Review Queue', icon: 'üìù' },
  { href: '/admin/articles/', label: 'Articles', icon: 'üì∞' },
  { href: '/admin/people/', label: 'People', icon: 'üë§' },
  { href: '/admin/timeline/', label: 'Timeline', icon: 'üìÖ' },
];
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>{title} ‚Äî Admin</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0f172a; color: #e2e8f0; min-height: 100vh; display: flex; }

    /* Sidebar */
    .sidebar { width: 240px; background: #1e293b; border-right: 1px solid #334155; display: flex; flex-direction: column; position: fixed; top: 0; left: 0; bottom: 0; z-index: 50; }
    .sidebar-brand { padding: 16px 20px; border-bottom: 1px solid #334155; font-size: 14px; font-weight: 700; color: #f97316; text-transform: uppercase; letter-spacing: 0.05em; text-decoration: none; display: block; }
    .sidebar-brand span { color: #94a3b8; font-weight: 400; font-size: 11px; display: block; margin-top: 2px; text-transform: none; letter-spacing: 0; }
    .sidebar-nav { flex: 1; padding: 8px 0; }
    .sidebar-nav a { display: flex; align-items: center; gap: 10px; padding: 10px 20px; color: #94a3b8; text-decoration: none; font-size: 14px; transition: all 0.15s; }
    .sidebar-nav a:hover { background: #334155; color: #e2e8f0; }
    .sidebar-nav a.active { background: #334155; color: #f97316; border-right: 3px solid #f97316; }
    .sidebar-user { padding: 16px 20px; border-top: 1px solid #334155; display: flex; align-items: center; gap: 10px; font-size: 13px; }
    .sidebar-user img { width: 28px; height: 28px; border-radius: 50%; }
    .sidebar-user a { color: #94a3b8; text-decoration: none; font-size: 12px; margin-left: auto; }
    .sidebar-user a:hover { color: #ef4444; }

    /* Main content */
    .main { margin-left: 240px; flex: 1; min-height: 100vh; }
    .topbar { padding: 16px 32px; border-bottom: 1px solid #334155; background: #1e293b; }
    .topbar h1 { font-size: 20px; font-weight: 600; }
    .content { padding: 24px 32px; }

    /* Utility classes */
    .badge { display: inline-block; padding: 2px 8px; border-radius: 9999px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
    .badge-green { background: #065f46; color: #6ee7b7; }
    .badge-yellow { background: #78350f; color: #fcd34d; }
    .badge-red { background: #7f1d1d; color: #fca5a5; }
    .badge-blue { background: #1e3a5f; color: #93c5fd; }
    .badge-gray { background: #374151; color: #9ca3af; }

    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; border: none; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; text-decoration: none; transition: all 0.15s; }
    .btn-primary { background: #f97316; color: #fff; }
    .btn-primary:hover { background: #ea580c; }
    .btn-secondary { background: #334155; color: #e2e8f0; }
    .btn-secondary:hover { background: #475569; }
    .btn-danger { background: #dc2626; color: #fff; }
    .btn-danger:hover { background: #b91c1c; }
    .btn-success { background: #059669; color: #fff; }
    .btn-success:hover { background: #047857; }
    .btn-sm { padding: 4px 10px; font-size: 12px; }

    .card { background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 20px; }
    .stat-card { text-align: center; }
    .stat-card .stat-value { font-size: 32px; font-weight: 700; color: #f97316; }
    .stat-card .stat-label { font-size: 12px; color: #94a3b8; margin-top: 4px; text-transform: uppercase; letter-spacing: 0.05em; }

    table { width: 100%; border-collapse: collapse; }
    th { text-align: left; padding: 10px 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: #64748b; border-bottom: 1px solid #334155; }
    td { padding: 10px 12px; font-size: 13px; border-bottom: 1px solid #1e293b; }
    tr:hover td { background: #1e293b; }

    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
    .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
    .flex { display: flex; }
    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 8px; }
    .gap-4 { gap: 16px; }
    .mb-4 { margin-bottom: 16px; }
    .mb-6 { margin-bottom: 24px; }
    .mt-4 { margin-top: 16px; }
    .text-sm { font-size: 13px; }
    .text-muted { color: #64748b; }
    .truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 400px; }

    /* Forms */
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; font-size: 12px; font-weight: 600; color: #94a3b8; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.03em; }
    .form-input { width: 100%; padding: 8px 12px; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0; font-size: 14px; font-family: inherit; }
    .form-input:focus { outline: none; border-color: #f97316; box-shadow: 0 0 0 2px rgba(249, 115, 22, 0.2); }
    select.form-input { cursor: pointer; }
    textarea.form-input { min-height: 200px; resize: vertical; font-family: 'JetBrains Mono', 'Fira Code', monospace; font-size: 13px; line-height: 1.6; }

    /* Editor */
    .editor-container { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .editor-pane { display: flex; flex-direction: column; }
    .editor-pane-header { font-size: 11px; font-weight: 600; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px; }
    .preview-pane { background: #0f172a; border: 1px solid #334155; border-radius: 6px; padding: 20px; min-height: 400px; overflow-y: auto; line-height: 1.7; font-size: 14px; }
    .preview-pane h2 { font-size: 18px; font-weight: 600; margin: 20px 0 8px; color: #f1f5f9; }
    .preview-pane h3 { font-size: 16px; font-weight: 600; margin: 16px 0 6px; color: #f1f5f9; }
    .preview-pane p { margin-bottom: 12px; color: #cbd5e1; }
    .preview-pane a { color: #f97316; }
    .preview-pane strong { color: #f1f5f9; }
    .preview-pane ul, .preview-pane ol { margin-bottom: 12px; padding-left: 20px; }
    .preview-pane li { margin-bottom: 4px; color: #cbd5e1; }
    .preview-pane blockquote { border-left: 3px solid #f97316; padding-left: 12px; margin: 12px 0; color: #94a3b8; }

    /* Alerts */
    .alert { padding: 12px 16px; border-radius: 6px; font-size: 13px; margin-bottom: 16px; }
    .alert-success { background: #065f46; color: #6ee7b7; border: 1px solid #059669; }
    .alert-error { background: #7f1d1d; color: #fca5a5; border: 1px solid #dc2626; }
    .alert-info { background: #1e3a5f; color: #93c5fd; border: 1px solid #3b82f6; }

    @media (max-width: 768px) {
      .sidebar { display: none; }
      .main { margin-left: 0; }
      .grid-4 { grid-template-columns: repeat(2, 1fr); }
      .editor-container { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <nav class="sidebar">
    <a class="sidebar-brand" href="/admin/">
      Epstein Transparency
      <span>Editorial CMS</span>
    </a>
    <div class="sidebar-nav">
      {navItems.map((item) => (
        <a href={item.href} class={activeNav === item.label ? 'active' : ''}>
          <span>{item.icon}</span> {item.label}
        </a>
      ))}
    </div>
    {user && (
      <div class="sidebar-user">
        {user.avatarUrl && <img src={user.avatarUrl} alt={user.login} />}
        <span>{user.name || user.login}</span>
        <a href="/admin/login/?logout=1">Logout</a>
      </div>
    )}
  </nav>

  <div class="main">
    <div class="topbar">
      <h1>{title}</h1>
    </div>
    <div class="content">
      <slot />
    </div>
  </div>
</body>
</html>
