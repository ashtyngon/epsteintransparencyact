---
import BaseLayout from '../layouts/BaseLayout.astro';
import ArticleCard from '../components/ArticleCard.astro';
import PersonCard from '../components/PersonCard.astro';
import { getCollection } from 'astro:content';
import { websiteJsonLd } from '../utils/json-ld';

const articles = (await getCollection('articles', (a) => a.data.status === 'published'))
  .sort((a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime())
  .slice(0, 6);

const people = (await getCollection('people')).slice(0, 6);
---

<BaseLayout
  title="Home"
  description="A factual database tracking developments around the Epstein Files and the Epstein Transparency Act. Latest news, people database, and timeline."
  jsonLd={websiteJsonLd()}
>
  <!-- Hero -->
  <section class="bg-primary text-white py-16 md:py-24">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 tracking-tight">
        Epstein Transparency Act
      </h1>
      <p class="text-lg md:text-xl text-white/70 max-w-2xl mx-auto leading-relaxed">
        A noise-free, factual database tracking developments around the
        Epstein Files and the Epstein Transparency Act.
      </p>
      <div class="flex flex-wrap justify-center gap-4 mt-8">
        <a
          href="/articles"
          class="bg-white text-primary px-6 py-3 rounded-lg font-semibold text-sm hover:bg-white/90 transition-colors"
        >
          Latest News
        </a>
        <a
          href="/timeline"
          class="border border-white/30 text-white px-6 py-3 rounded-lg font-semibold text-sm hover:bg-white/10 transition-colors"
        >
          View Timeline
        </a>
      </div>
    </div>
  </section>

  <!-- Latest Articles -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold text-primary">Latest News</h2>
      <a href="/articles" class="text-sm text-accent hover:underline">View all</a>
    </div>

    {articles.length > 0 ? (
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {articles.map((article) => (
          <ArticleCard article={article} />
        ))}
      </div>
    ) : (
      <p class="text-text-muted text-center py-12">
        No articles yet. The automated pipeline will populate this section.
      </p>
    )}
  </section>

  <!-- People Section -->
  <section class="bg-white border-y border-border">
    <div class="max-w-6xl mx-auto px-4 py-12">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-primary">People Database</h2>
        <a href="/people" class="text-sm text-accent hover:underline">View all</a>
      </div>

      {people.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {people.map((person) => (
            <PersonCard person={person} />
          ))}
        </div>
      ) : (
        <p class="text-text-muted text-center py-12">
          People database will be populated as the project develops.
        </p>
      )}
    </div>
  </section>

  <!-- About Teaser -->
  <section class="max-w-4xl mx-auto px-4 py-12 text-center">
    <h2 class="text-2xl font-bold text-primary mb-4">What Is This?</h2>
    <p class="text-text-muted leading-relaxed max-w-2xl mx-auto">
      This site aggregates factual reporting from major news outlets about
      the Epstein Files and the Epstein Transparency Act. Every article links
      back to its original source. Our goal is to provide a clear, searchable,
      noise-free record of developments.
    </p>
    <a
      href="/about"
      class="inline-block mt-4 text-accent hover:underline text-sm"
    >
      Learn more about this project
    </a>
  </section>
</BaseLayout>
